// 1 initial ascent
// 2 gravity turn to 40s TtAP
// 3 gravity turn to end of turn
// 4 burn to Ap > target
// 5 coast to alt > 55km
// 6 coast to 70km (space)
// 7 spaaaaace
----------------------------------------------------


parameter phase is 0.

setup code
initiation
set phase 1

heartbeat loop (phases 1-6):
	phasecheck
	steering
	throttle
	fuel/thrust monitor

run circularization program
end.


----------------------------------------------------


steering
//	if phase 1
	if phase 2
		code
	if phase 3
		code
	if phase 4
//	if phase 5
//	if phase 6


throttle
	if phase 1
		code
	if phase 2
		code
	if phase 3
		code (pidloop)
	if phase 4
		code (pidloop?)
//	if phase 5
//	if phase 6


phasecheck
	if phase 1
		if phase 2 condition
			exit code
			set phase 2
	if phase 2
		if phase 3 condition
			exit code
			set phase 3
	if phase 3
		if phase 4 condition
			exit code
			set phase 4
	if phase 4
		if phase 5 condition
			exit code
			set phase 5
	if phase 5
		if phase 6 condition
			exit code
			set phase 6


fuel/thrust monitor
	if stage fuel = 0 stage
	if node
		if fuel < threshold stage


maxTWR (as anonymous function?)
	code
